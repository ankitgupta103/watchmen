import rsa

# Generate RSA key pair
(pubkey, privkey) = rsa.newkeys(2048)

# Save public key in DER format
with open("pubkey.der", "wb") as f:
    f.write(pubkey.save_pkcs1(format='DER'))

# Save private key in DER format
with open("privkey.der", "wb") as f:
    f.write(privkey.save_pkcs1(format='DER'))

# Print components for use in custom encryption
print("----- PUBLIC KEY -----")
print("n =", pubkey.n)
print("e =", pubkey.e)

print("\n----- PRIVATE KEY -----")
print("n =", privkey.n)
print("e =", privkey.e)
print("d =", privkey.d)
print("p =", privkey.p)
print("q =", privkey.q)



# Public Key: PublicKey(7697071855362940996665223194653075214494363015019424906600380485491708839779410629463169517518847799932056092639029220642602735135117570242020637287678859, 65537)
# Private Key: PrivateKey(7697071855362940996665223194653075214494363015019424906600380485491708839779410629463169517518847799932056092639029220642602735135117570242020637287678859, 65537, 4571006250068292164581999278818036946276463807384470106426702603038547809397888817111228837839874654420977511523503144228040636929288075885024702977746113, 6672796049506519112862542854248021598914188762404869430407300871182822890582516533, 1153500241616431738418165964107270428348907528200716169016112855670924223)
