from rsa.key import PublicKey, PrivateKey
from logger import logger



class PrivKeyRepo:
    def __init__(self):
        self.n_pub = {}
        self.e_pub = {}

        self.n_pvt = {}
        self.e_pvt = {}
        self.d_pvt = {}
        self.p_pvt = {}
        self.q_pvt = {}
        self.pvtkey = {}
        self.init_repo()

    def init_repo(self):
        #----- PUBLIC KEY -----
        self.n_pub[219] = 90534273190280508921272648792305316460909298006713549130803347215283394625727646952180658078434711453384155386929777899560163210594802905003334134078605908801122343988560836135987507614276777012993718001269029065891845694499696332899332365276446197289737551331061379916355271905441350899703520297788485680877
        self.e_pub[219] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[219] = 90534273190280508921272648792305316460909298006713549130803347215283394625727646952180658078434711453384155386929777899560163210594802905003334134078605908801122343988560836135987507614276777012993718001269029065891845694499696332899332365276446197289737551331061379916355271905441350899703520297788485680877
        self.e_pvt[219] = 65537
        self.d_pvt[219] = 6652929790567022154887301472202609275306150406645596420555547556171396745617046061334849768920481107763524304491414168550311213852092265292827822845420791395571249023312605997939106169080743315614961960320384868749289985587613538279762371637177628033934414671509173001175709662187311547879418446544163205313
        self.p_pvt[219] = 34032853748150882941984330735541159483609157914450164147172178551929756361735804952060354761070135303276319717339339506793242366580014632718461949320194787722147067
        self.q_pvt[219] = 2660202222835912907517775699216596646827114342762542830764040377898325138871971352595293118273800795311138678790700864729424179979436230658885431
        self.pvtkey[219] = PrivateKey(self.n_pvt[219], self.e_pvt[219], self.d_pvt[219], self.p_pvt[219], self.q_pvt[219])

        #----- PUBLIC KEY -----
        self.n_pub[221] = 93707570084882290967203367102885687072410701389989352055861123607039021853225999041041941636338758170666665448059059611663612872782499619381386775526365690664987324671998372135663320340834574407710804137444077738151368134385803551377563991839820527547363888541191583559632075302668890641139065893216092760433
        self.e_pub[221] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[221] = 93707570084882290967203367102885687072410701389989352055861123607039021853225999041041941636338758170666665448059059611663612872782499619381386775526365690664987324671998372135663320340834574407710804137444077738151368134385803551377563991839820527547363888541191583559632075302668890641139065893216092760433
        self.e_pvt[221] = 65537
        self.d_pvt[221] = 31879762311557373077876104687824271464462349484889491332186087430650503246098034310680548861312067262358423071393637076791002221822155599336670868216466177243478638887159312729623186815494080934218165166000971730420832226449506712502882479917256071492002352684229761177092452273616307937685074298487285344897
        self.p_pvt[221] = 38429911445149833951371210373344454274023014889834685024456192938205032138694076309921269179804520129227034941611279228212270479962709242789649601933270155170896277
        self.q_pvt[221] = 2438401926026528619589839976007101134431690425310990144329759559946160527662098251976984822789108645921600279308294179959382635683291343967269229
        self.pvtkey[221] = PrivateKey(self.n_pvt[221], self.e_pvt[221], self.d_pvt[221], self.p_pvt[221], self.q_pvt[221])

        #----- PUBLIC KEY -----
        self.n_pub[222] = 150591062598696302235376946462498450008450918994284047265606641980394129634552407567595675857217911105250762990865544710930996346638187379379415379590157992358838419337159827356397700679924622001852031458748867661937042970721924459833449757706445144584715633715967624839795643674396916237363708215781894407791
        self.e_pub[222] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[222] = 150591062598696302235376946462498450008450918994284047265606641980394129634552407567595675857217911105250762990865544710930996346638187379379415379590157992358838419337159827356397700679924622001852031458748867661937042970721924459833449757706445144584715633715967624839795643674396916237363708215781894407791
        self.e_pvt[222] = 65537
        self.d_pvt[222] = 98143727447327715047643623255660677125302587120006412054390510585876589788226535117981392300738383190067756974927890286300634999429486539634917491170908523466067207763023236403156520771021650465133479660691944088369211418304618017007604471302308992761861262890997429491003636533700594145770042507245778176257
        self.p_pvt[222] = 48562160429556917490145949098052263904891189501609638643875419874822903858089004363166696079882121449092158116738275153811840401205239847372949297318100169629868479
        self.q_pvt[222] = 3100995945539532070236889130821754199146290972148841833300863708722884809137718836086641009328431839788450042843390788168533165395645735729506129
        self.pvtkey[222] = PrivateKey(self.n_pvt[222], self.e_pvt[222], self.d_pvt[222], self.p_pvt[222], self.q_pvt[222])

        #----- PUBLIC KEY -----
        self.n_pub[223] = 127528187326170148180006031911881326061650602191733759250321117126508060892052551860477154781426544240729201974110610437216804843467179236249180253238134487792075185628568836250495796302827146249511888054212242147972553005407511318135297836644633874777195377549131488211350027928719273007716047079332345919421
        self.e_pub[223] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[223] = 127528187326170148180006031911881326061650602191733759250321117126508060892052551860477154781426544240729201974110610437216804843467179236249180253238134487792075185628568836250495796302827146249511888054212242147972553005407511318135297836644633874777195377549131488211350027928719273007716047079332345919421
        self.e_pvt[223] = 65537
        self.d_pvt[223] = 92885400519209085756510183976711525065639712605401822848998706149453526689064749843722118899806440068769820514094265508187847512062839825794869587182822330722988301511150381977967570242674398012828853439596198756885005246157992952441206864262907607595200300338240539882323449485265946016452462392736137486657
        self.p_pvt[223] = 43425409237685390548759302347222551291612574803096537328197860587879944687778162065109067093352062539030612612717037662304322823619727102567081890136879604092042553
        self.q_pvt[223] = 2936718146469389582601297886736861002059585909140236928184101012804699423861479103771156524628851284194944213509451965004746786964629846235976357
        self.pvtkey[223] = PrivateKey(self.n_pvt[223], self.e_pvt[223], self.d_pvt[223], self.p_pvt[223], self.q_pvt[223])

        #----- PUBLIC  KEY -----
        self.n_pub[224] = 101123733278619566324860465120100790269977109194846782293102851762695910786857650286430674928003040308104019468790481875450274465693092162639333661975726009318497509657765246935550572913929594485563050220666313024422354618945355245885039321560116279556602376588481298046921724850878858012102549877194388372779
        self.e_pub[224] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[224] = 101123733278619566324860465120100790269977109194846782293102851762695910786857650286430674928003040308104019468790481875450274465693092162639333661975726009318497509657765246935550572913929594485563050220666313024422354618945355245885039321560116279556602376588481298046921724850878858012102549877194388372779
        self.e_pvt[224] = 65537
        self.d_pvt[224] = 5108880188069478067375879274496142890029970986528795888924783590739371051700347591412056772305996100830559965533443482149257041913878086432073998542956097776458743929711178875031643751763688388443543107399032298912394675425682631880350385774552957431059065539388255532544197473132408212030289442059585999153
        self.p_pvt[224] = 33914803695825360478309566325951603818993918844220627218820044120655745820464097835514048272686904156921006532628321627889674609297909674337669878220902171576958249
        self.q_pvt[224] = 2981698911943491049734164526793650876816022258882170460508404462454415285742929327775596485339249973884712889572879990797300294676554527768337971
        self.pvtkey[224] = PrivateKey(self.n_pvt[224], self.e_pvt[224], self.d_pvt[224], self.p_pvt[224], self.q_pvt[224])

        #----- PUBLIC  KEY -----
        self.n_pub[225] = 100992938952896040702305390879412363689726961366059216479928260739102736815458714080336612890023113294016430635344284504233377479193361647207169105560545100390107803140767116962969160593280467354102153104487334391311296615305434200217962848973396416976292733723171973717047751468315932187424537195629872091113
        self.e_pub[225] = 65537
        #----- PRIVATE KEY -----
        self.n_pvt[225] = 100992938952896040702305390879412363689726961366059216479928260739102736815458714080336612890023113294016430635344284504233377479193361647207169105560545100390107803140767116962969160593280467354102153104487334391311296615305434200217962848973396416976292733723171973717047751468315932187424537195629872091113
        self.e_pvt[225] = 65537
        self.d_pvt[225] = 22595777406141792343529669445730251442428955162893118257552040636853432868838535858522296638637852056550695369120546312549765994436917494438236721581378773688957608424685869795801948115247755801108165431315371882357638280255227425316627988737232654361612158660759617330781550773826487554646986371168760194433
        self.p_pvt[225] = 39047633643576821652881401819474343412048720758839459965242455033803047700132502336573148258550433916244519035053076790929209273760420549888643352054922381413029553
        self.q_pvt[225] = 2586403567364676197045617324832092516043706205856348399048915977680743860439992660526484607060572030431331245961786068811404067057339245387598521
        self.pvtkey[225] = PrivateKey(self.n_pvt[225], self.e_pvt[225], self.d_pvt[225], self.p_pvt[225], self.q_pvt[225])

    def get_pvt_key(self, nodeaddr):
        if nodeaddr not in self.pvtkey:
            logger.error(f"No pvt key for {nodeaddr}")
            return None
        return self.pvtkey[nodeaddr]

def main():
    p = PrivKeyRepo()
    logger.info(str(p.get_pvt_key(9)))

if __name__ == "__main__":
    main()
